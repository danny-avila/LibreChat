{"version":3,"file":"index.esm.js","sources":["../../src/index.tsx"],"sourcesContent":["import * as React from 'react'\nimport { flushSync } from 'react-dom'\nimport {\n  elementScroll,\n  observeElementOffset,\n  observeElementRect,\n  observeWindowOffset,\n  observeWindowRect,\n  PartialKeys,\n  Virtualizer,\n  VirtualizerOptions,\n  windowScroll,\n} from '@tanstack/virtual-core'\nexport * from '@tanstack/virtual-core'\n\n//\n\nconst useIsomorphicLayoutEffect =\n  typeof document !== 'undefined' ? React.useLayoutEffect : React.useEffect\n\nfunction useVirtualizerBase<\n  TScrollElement extends Element | Window,\n  TItemElement extends Element,\n>(\n  options: VirtualizerOptions<TScrollElement, TItemElement>,\n): Virtualizer<TScrollElement, TItemElement> {\n  const rerender = React.useReducer(() => ({}), {})[1]\n\n  const resolvedOptions: VirtualizerOptions<TScrollElement, TItemElement> = {\n    ...options,\n    onChange: (instance, sync) => {\n      if (sync) {\n        flushSync(rerender)\n      } else {\n        rerender()\n      }\n      options.onChange?.(instance, sync)\n    },\n  }\n\n  const [instance] = React.useState(\n    () => new Virtualizer<TScrollElement, TItemElement>(resolvedOptions),\n  )\n\n  instance.setOptions(resolvedOptions)\n\n  React.useEffect(() => {\n    return instance._didMount()\n  }, [])\n\n  useIsomorphicLayoutEffect(() => {\n    return instance._willUpdate()\n  })\n\n  return instance\n}\n\nexport function useVirtualizer<\n  TScrollElement extends Element,\n  TItemElement extends Element,\n>(\n  options: PartialKeys<\n    VirtualizerOptions<TScrollElement, TItemElement>,\n    'observeElementRect' | 'observeElementOffset' | 'scrollToFn'\n  >,\n): Virtualizer<TScrollElement, TItemElement> {\n  return useVirtualizerBase<TScrollElement, TItemElement>({\n    observeElementRect: observeElementRect,\n    observeElementOffset: observeElementOffset,\n    scrollToFn: elementScroll,\n    ...options,\n  })\n}\n\nexport function useWindowVirtualizer<TItemElement extends Element>(\n  options: PartialKeys<\n    VirtualizerOptions<Window, TItemElement>,\n    | 'getScrollElement'\n    | 'observeElementRect'\n    | 'observeElementOffset'\n    | 'scrollToFn'\n  >,\n): Virtualizer<Window, TItemElement> {\n  return useVirtualizerBase<Window, TItemElement>({\n    getScrollElement: () => (typeof document !== 'undefined' ? window : null),\n    observeElementRect: observeWindowRect,\n    observeElementOffset: observeWindowOffset,\n    scrollToFn: windowScroll,\n    initialOffset: typeof document !== 'undefined' ? window.scrollY : undefined,\n    ...options,\n  })\n}\n"],"names":["useIsomorphicLayoutEffect","document","React","useLayoutEffect","useEffect","useVirtualizerBase","options","rerender","useReducer","resolvedOptions","_extends","onChange","instance","sync","flushSync","_React$useState","useState","Virtualizer","setOptions","_didMount","_willUpdate","useVirtualizer","observeElementRect","observeElementOffset","scrollToFn","elementScroll","useWindowVirtualizer","getScrollElement","window","observeWindowRect","observeWindowOffset","windowScroll","initialOffset","scrollY","undefined"],"mappings":";;;;;;;;;;;;;;;;AAeA;;AAEA,IAAMA,yBAAyB,GAC7B,OAAOC,QAAQ,KAAK,WAAW,GAAGC,KAAK,CAACC,eAAe,GAAGD,KAAK,CAACE,SAAS,CAAA;AAE3E,SAASC,kBAAkBA,CAIzBC,OAAyD,EACd;AAC3C,EAAA,IAAMC,QAAQ,GAAGL,KAAK,CAACM,UAAU,CAAC,YAAA;AAAA,IAAA,OAAO,EAAE,CAAA;AAAA,GAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAA;AAEpD,EAAA,IAAMC,eAAiE,GAAAC,QAAA,CAAA,EAAA,EAClEJ,OAAO,EAAA;AACVK,IAAAA,QAAQ,EAAE,SAAAA,QAAAA,CAACC,QAAQ,EAAEC,IAAI,EAAK;AAC5B,MAAA,IAAIA,IAAI,EAAE;QACRC,SAAS,CAACP,QAAQ,CAAC,CAAA;AACrB,OAAC,MAAM;AACLA,QAAAA,QAAQ,EAAE,CAAA;AACZ,OAAA;MACAD,OAAO,CAACK,QAAQ,IAAA,IAAA,IAAhBL,OAAO,CAACK,QAAQ,CAAGC,QAAQ,EAAEC,IAAI,CAAC,CAAA;AACpC,KAAA;GACD,CAAA,CAAA;AAED,EAAA,IAAAE,eAAA,GAAmBb,KAAK,CAACc,QAAQ,CAC/B,YAAA;AAAA,MAAA,OAAM,IAAIC,WAAW,CAA+BR,eAAe,CAAC,CAAA;AAAA,KACtE,CAAC;AAFMG,IAAAA,QAAQ,GAAAG,eAAA,CAAA,CAAA,CAAA,CAAA;AAIfH,EAAAA,QAAQ,CAACM,UAAU,CAACT,eAAe,CAAC,CAAA;EAEpCP,KAAK,CAACE,SAAS,CAAC,YAAM;AACpB,IAAA,OAAOQ,QAAQ,CAACO,SAAS,EAAE,CAAA;GAC5B,EAAE,EAAE,CAAC,CAAA;AAENnB,EAAAA,yBAAyB,CAAC,YAAM;AAC9B,IAAA,OAAOY,QAAQ,CAACQ,WAAW,EAAE,CAAA;AAC/B,GAAC,CAAC,CAAA;AAEF,EAAA,OAAOR,QAAQ,CAAA;AACjB,CAAA;AAEO,SAASS,cAAcA,CAI5Bf,OAGC,EAC0C;EAC3C,OAAOD,kBAAkB,CAAAK,QAAA,CAAA;AACvBY,IAAAA,kBAAkB,EAAEA,kBAAkB;AACtCC,IAAAA,oBAAoB,EAAEA,oBAAoB;AAC1CC,IAAAA,UAAU,EAAEC,aAAAA;GACTnB,EAAAA,OAAO,CACX,CAAC,CAAA;AACJ,CAAA;AAEO,SAASoB,oBAAoBA,CAClCpB,OAMC,EACkC;EACnC,OAAOD,kBAAkB,CAAAK,QAAA,CAAA;IACvBiB,gBAAgB,EAAE,SAAAA,gBAAA,GAAA;AAAA,MAAA,OAAO,OAAO1B,QAAQ,KAAK,WAAW,GAAG2B,MAAM,GAAG,IAAI,CAAA;KAAC;AACzEN,IAAAA,kBAAkB,EAAEO,iBAAiB;AACrCN,IAAAA,oBAAoB,EAAEO,mBAAmB;AACzCN,IAAAA,UAAU,EAAEO,YAAY;IACxBC,aAAa,EAAE,OAAO/B,QAAQ,KAAK,WAAW,GAAG2B,MAAM,CAACK,OAAO,GAAGC,SAAAA;GAC/D5B,EAAAA,OAAO,CACX,CAAC,CAAA;AACJ;;;;"}