kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ include "brainiac.fullname" $ }}-configenv
data:
  {{- if (index .Values "brainiac-rag-api" "enabled") }}
  RAG_API_URL: http://{{ include "rag.fullname" (index .Subcharts "brainiac-rag-api") | lower }}.{{ .Release.Namespace | lower }}.svc.cluster.local:8000 
  {{- end }}
  {{- if and (not (dig "configEnv" "MEILI_HOST" "" .Values.brainiac)) .Values.meilisearch.enabled }}
  MEILI_HOST: http://{{ include "meilisearch.fullname" .Subcharts.meilisearch }}.{{ .Release.Namespace | lower }}.svc.cluster.local:7700
  {{- end }}
  {{- if and (not (dig "configEnv" "MONGO_URI" "" .Values.brainiac)) .Values.mongodb.enabled }}
  MONGO_URI: mongodb://{{ include "mongodb.service.nameOverride" .Subcharts.mongodb }}.{{ .Release.Namespace | lower }}.svc.cluster.local:27017/Brainiac
  {{- end }}
  {{- if .Values.brainiac.configEnv }}
  {{- toYaml .Values.brainiac.configEnv | nindent 2 }}
  {{- end }}